\chapter{Introduction}
\label{chap:introduction}
In the last years, we have seen a constant transition from physical to virtual. This is the case of bank transactions, government documents, health care data, and almost anything that can be virtualized. This is a significant step forward, the storage is optimized and more easily accessible, facilitating the cataloging of the documents. However, there are also some big concerns about the security of that data, as it is virtual, the access to it is regulated by some authentication protocols instead of a physical identification of the subject accessing the physical documents. This means that it has to be checked whether the person accessing the data is the one that is claiming to be. The three basic principles over which data security is based are confidentiality, integrity, and data availability. This principle is called the CIA triad \cite{cia_triad}.
If those requirements are not met, sensitive data could be made inaccessible or even at the risk of access from unauthorized parties. As a result, critical services for health care could be inaccessible, and this is what happened for example in Lazio \cite{lazio_hacker_0,lazio_hacker_1}, Italy, in August 2021, where, because of a RansomWare infecting the internal computer network of the region and keeping it down for multiple days, the covid vaccines and other health-care services could not be booked. Moreover, many data in the systems have been encrypted and denied access. It has to be said that preventing RansomWares infections is not the aim of this thesis, but this is an excellent example of what the consequences of exploiting a vulnerability could be. 

In this thesis, the considered services are web services (from now on service) that rely on browser-based HTTP security protocols. Browser-based protocols are those used to secure web services communications, authentications, and identification. The development has been done with a particular focus over Identity Management (IdM) protocols such as \gls{SAML} and \gls{OAuth} but without limiting the possible applications to these protocols.
To ensure that the CIA triad requirements are satisfied, there is a need to test all the implementations of the protocols used by the service that is liable for the security of the data. The services that provide access to the data have to be appropriately designed and tested by a software engineer or a security tester (from now on tester) over the well-known vulnerabilities. The well-known vulnerabilities are vulnerabilities of the protocols that have been discovered over time and that are known to exist. The service should be built to avoid them and should be tested over them. However, there could arise some problems, for instance, the tester should be qualified to test the protocols and should know how they work. This is not always the case, as software engineers are sometimes responsible for that. Another problem is that due to the fast-evolving nature of protocols, new vulnerabilities will eventually be found, and so, new tests will have to be defined, or old tests will have to be edited. This is much work to be done by the tester. The result is that some vulnerabilities could remain undiscovered, representing a weakness in the system. This thesis proposes a new automated testing software and a language to help the tester to test the web protocols used in the services mentioned above. 

Some software to test specific protocols and vulnerabilities already exist \cite{wendy_barreto,claudio_grisenti}, but they are usually very specific and hard-coded in a way that the tester could not easily edit the tests. Other tools exist, but they are not usually automated. With this work, I wanted to create a software that could test any browser-based HTTP protocol and abstractly specify the tests, allowing the editing and adding. To do this, a new language will be used to specify the tests, and a software will be implemented to execute them. The test results will be evaluated by an oracle, which is composed of a series of components that are responsible for telling if the test is passed or not.

This thesis will discuss the design and implementation of this new software.

\section{Contributions}
\label{sec:contributions}
The contributions of this thesis are the following:
\begin{itemize}
    %parola chiave: spiegazione 
    \item \textit{Design of a declarative specification of pentesting strategies}: One contribution of this thesis is the design of a language that will serve as a declarative specification of pentesting strategies. The pentesting strategies are the ensemble of actions done on messages exchanged by protocols to verify if the service implementing the protocol is vulnerable to known vulnerabilities. The objective of this language is to fix a standard that could define the necessary pentesting strategies. The language supports all the possible actions needed by a pentester to edit the messages, for instance, remove, add, and edit to be done on parts of the message. To verify if the service is vulnerable, there are also dedicated actions in the language to check the content of the messages. For example, to verify that the service is not vulnerable to a tested vulnerability, there could be the need to check the value or the presence of a specific parameter in the content of a specific message. This is done using a specific action in the language. The language also manages the browsers, making it possible to work on multiple sessions at once and, for example, to reply messages from one browser to another.
    % Design. automatically execute. Più a livello teorico
    \item \textit{Design of an approach to execute the pentesting strategies}: In this contribution, an approach to execute the tests specified in the language has been designed. The goal was to have a software that could automatically execute the specified tests. To do that, a browser would have to do a series of automated actions, and the messages exchanged by the browser would have to be intercepted. The actions to be done on the browser had to be defined. The tests have to be executed over these intercepted messages and then give a result. For the automation actions, there was an already working solution \cite{wendy_barreto, claudio_grisenti} that has been taken as a starting point. My contribution was to design the test execution and how the tests would interact with the browser and to extend the automation part to manage multiple sessions and new actions.
    % Com'è fatto il tool, cosa uso. Burp, proxy, plugin,.. più a livello pratico
    \item \textit{Implementation of a tool to execute the pentesting strategies} This contribution is about implementing the previously introduced language and approach to execute pentesting strategies over browser-based protocols. Burp Suite has been chosen as the platform to be used as the ground for the implementation; it is based on a browser and a proxy that intercepts the traffic from it. It admits the execution of plugins written in java that use a set of APIs to interact with its proxy. The tool will then be a plugin for Burp. The language has been implemented using JSON; then, a dedicated parser has been built in the tool to parse the tests written in the language. The parsed language is executed with the automated actions in the browser. The tool is able to intercept the traffic from the browser using Burp's APIs. Then, based on the language actions, it manipulates the messages before sending them back to the proxy. The last step is the execution of the checks specified in the tests; an oracle has been implemented using the checks defined in every test to evaluate the tests' correctness and give a result.
    \item \textit{Specification of a test suite for OAuth and OIDC protocols} In this contribution, a test suite containing the well-known vulnerabilities of OAuth and OIDC protocols have been defined using the new language. The OAuth/OIDC tests defined in \cite{claudio_grisenti, wendy_barreto} were taken and defined with the new language, and new tests were also introduced, given the new possibilities introduced with the language and the tool.
    \item \textit{Experimental analysis of the OAuth and OIDC test suite} This contribution is about the analysis of the defined OAuth and OIDC test suite. It has been used during the development of the tool to test its functioning, comparing the obtained results with the results of different tools and manually checking the results over multiple protocol implementations to check its validity.
\end{itemize}

\section{Structure of the thesis}
The thesis is structured as follows:
\begin{itemize}
    \item \textbf{Chapter \ref{chap:Background}, Background}: A brief introduction over the concepts and software used in the rest of the thesis
    \item \textbf{Chapter \ref{chap:Design}, Design of the testing language}: The design of the tool and the testing language
    \item \textbf{Chapter \ref{chap:Implementation}, Implementation}: The implementation of the tool and the testing language
    \item \textbf{Chapter \ref{chap:Use_cases}, Use cases}: Some examples of application of the software and the language described in this thesis
    \item \textbf{Chapter \ref{chap:Related_work}, Related work}: Other works related to the one of this thesis
    \item \textbf{Chapter \ref{chap:Conclusions}, Conclusions and future works}: Conclusions, results, and works that could be done in the future
\end{itemize}




